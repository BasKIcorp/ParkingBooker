# ParkingBooker - Система бронирования парковочных мест

## 📋 Описание проекта

**ParkingBooker** - это веб-приложение для бронирования парковочных мест в аэропорту Шереметьево. Система предоставляет удобный интерфейс для пользователей и административную панель для управления настройками парковки.

### 🎯 Основные возможности

- **Бронирование парковочных мест** с указанием даты и времени
- **Автоматический расчет стоимости** на основе почасовой тарификации
- **Проверка доступности** мест в реальном времени
- **Административная панель** для управления настройками
- **Адаптивный дизайн** для мобильных устройств
- **Валидация данных** на стороне сервера и клиента

## 🏗️ Архитектура проекта

### Технологический стек

#### Backend
- **Flask** - веб-фреймворк
- **SQLAlchemy** - ORM для работы с базой данных
- **Alembic** - система миграций базы данных
- **Werkzeug** - утилиты для веб-приложений

#### Frontend
- **HTML5** - разметка страниц
- **CSS3** - стилизация интерфейса
- **JavaScript** - интерактивность на стороне клиента

#### База данных
- **SQLite** - встроенная база данных (для разработки)
- **PostgreSQL** - для продакшена (настраивается через переменные окружения)

#### Контейнеризация
- **Docker** - контейнеризация приложения
- **Docker Compose** - оркестрация сервисов
- **Nginx** - веб-сервер и прокси

## 📁 Структура проекта

```
ParkingBooker/
├── 📄 app.py                 # Конфигурация Flask приложения
├── 📄 models.py              # Модели базы данных (SQLAlchemy)
├── 📄 routes.py              # Маршруты и контроллеры
├── 📄 utils.py               # Утилиты и вспомогательные функции
├── 📄 main.py                # Точка входа приложения
├── 📄 req.txt                # Зависимости Python
├── 📄 pyproject.toml         # Конфигурация Poetry
├── 📄 uv.lock                # Lock файл зависимостей
│
├── 📁 templates/             # HTML шаблоны
│   ├── 📄 base.html          # Базовый шаблон
│   ├── 📄 index.html         # Главная страница с формой бронирования
│   ├── 📄 success.html       # Страница успешного бронирования
│   ├── 📄 cancel.html        # Страница отмены бронирования
│   ├── 📄 admin.html         # Административная панель
│   └── 📄 admin_login.html   # Страница входа в админ панель
│
├── 📁 static/                # Статические файлы
│   ├── 📁 css/
│   │   └── 📄 style.css      # Стили приложения
│   ├── 📁 js/
│   │   └── 📄 main.js        # JavaScript функциональность
│   └── 📁 images/            # Изображения и иконки
│       ├── 📄 car.png
│       ├── 📄 car-3d.png
│       ├── 📄 car-new.png
│       ├── 📄 calendar.png
│       ├── 📄 parking-sign-1.png
│       └── 📄 plane.png
│
├── 📁 migrations/            # Миграции базы данных (Alembic)
│   ├── 📄 env.py
│   ├── 📄 script.py.mako
│   └── 📁 versions/
│
├── 📁 instance/              # База данных SQLite (создается автоматически)
│
├── 📄 Dockerfile             # Конфигурация Docker контейнера
├── 📄 Dockerfile.alpine      # Альтернативный Dockerfile на Alpine Linux
├── 📄 Dockerfile.nginx       # Dockerfile для Nginx
├── 📄 Dockerfile.nginx.prod  # Продакшн версия Nginx
├── 📄 docker-compose.yml     # Конфигурация Docker Compose
├── 📄 docker-compose.prod.yml # Продакшн конфигурация
├── 📄 nginx.conf             # Конфигурация Nginx
├── 📄 nginx-ssl.conf         # SSL конфигурация Nginx
│
├── 📄 alembic.ini            # Конфигурация Alembic
├── 📄 start.sh               # Скрипт запуска
├── 📄 cleanup.sh             # Скрипт очистки
├── 📄 fix-deploy.sh          # Скрипт исправления деплоя
├── 📄 check_deployment.py    # Скрипт проверки деплоя
│
├── 📄 env.example            # Пример переменных окружения
├── 📄 README.md              # Документация проекта
├── 📄 PROJECT_ARCHITECTURE.md # Архитектурная документация
├── 📄 GITHUB_SETUP.md        # Настройка GitHub
├── 📄 NGINX_SETUP.md         # Настройка Nginx
│
└── 📁 ssl/                   # SSL сертификаты (для продакшена)
```

## 🗄️ Модели данных

### ParkingSettings
Настройки парковки, управляемые администратором:
- `total_spots` - общее количество парковочных мест
- `reserve_spots` - количество зарезервированных мест
- `hourly_price` - стоимость за час парковки
- `created_at` / `updated_at` - временные метки

### Booking
Записи о бронированиях:
- `first_name` / `last_name` - имя и фамилия клиента
- `phone` - номер телефона
- `booking_date` - дата бронирования
- `booking_start_hour` / `booking_end_hour` - время начала и конца
- `total_amount` - общая стоимость
- `created_at` / `updated_at` - временные метки

### AdminUser
Пользователи административной панели:
- `username` - имя пользователя
- `password_hash` - хеш пароля
- `created_at` - дата создания

## 🛣️ Маршруты приложения

### Публичные маршруты
- `GET /` - главная страница с формой бронирования
- `POST /book_parking` - обработка бронирования
- `GET /success/<booking_id>` - страница успешного бронирования
- `GET /cancel/<booking_id>` - отмена бронирования

### Административные маршруты
- `GET /admin` - административная панель
- `GET /admin/login` - страница входа
- `POST /admin/login` - обработка входа
- `GET /admin/logout` - выход из системы
- `POST /admin/update_settings` - обновление настроек

### Отладочные маршруты
- `GET /debug/bookings` - просмотр всех бронирований
- `GET /debug/database` - информация о базе данных

## 🔧 Установка и запуск

### Способ 1: Docker (рекомендуется)

1. **Клонирование репозитория:**
```bash
git clone <repository-url>
cd ParkingBooker
```

2. **Запуск с помощью Docker Compose:**
```bash
docker-compose up --build
```

3. **Открытие в браузере:**
```
http://localhost:5000
```

### Способ 2: Локальная установка

1. **Установка Python 3.8+:**
```bash
# Ubuntu/Debian
sudo apt update
sudo apt install python3 python3-pip python3-venv

# Windows
# Скачайте Python с официального сайта
```

2. **Создание виртуального окружения:**
```bash
python3 -m venv venv
source venv/bin/activate  # Linux/Mac
# или
venv\Scripts\activate     # Windows
```

3. **Установка зависимостей:**
```bash
pip install -r req.txt
```

4. **Запуск приложения:**
```bash
python main.py
```

5. **Открытие в браузере:**
```
http://localhost:5000
```

## 🔐 Административная панель

### Доступ к админ панели
1. Перейдите по адресу: `http://localhost:5000/admin`
2. Используйте учетные данные по умолчанию:
   - **Логин:** `admin`
   - **Пароль:** `admin123`

### Возможности админ панели
- **Просмотр статистики** - количество бронирований, доходы
- **Управление настройками** - изменение количества мест, цен
- **Просмотр бронирований** - список всех бронирований
- **Экспорт данных** - выгрузка статистики

## 🚀 Продакшн деплой

### Настройка переменных окружения
Создайте файл `.env` на основе `env.example`:
```bash
cp env.example .env
```

Настройте переменные:
```env
FLASK_ENV=production
SESSION_SECRET=your-super-secret-key
DATABASE_URL=postgresql://user:password@localhost/parking_db
```

### Запуск в продакшне
```bash
docker-compose -f docker-compose.prod.yml up --build
```

### SSL сертификаты
Для HTTPS настройте SSL сертификаты в папке `ssl/` и используйте `nginx-ssl.conf`.

## 🧪 Тестирование

### Запуск тестов
```bash
python -m pytest tests/
```

### Проверка деплоя
```bash
python check_deployment.py
```

## 🔍 Отладка

### Просмотр логов
```bash
# Docker
docker-compose logs web

# Локально
tail -f app.log
```

### Отладочные маршруты
- `/debug/bookings` - просмотр всех бронирований
- `/debug/database` - информация о базе данных

## 📊 Мониторинг

### Health Check
Приложение включает встроенную проверку здоровья:
```bash
curl http://localhost:5000/
```

### Метрики
- Количество активных бронирований
- Доходы за период
- Загрузка парковки

## 🔧 Конфигурация

### Основные настройки
- **Количество мест:** настраивается в админ панели
- **Цена за час:** настраивается в админ панели
- **Резервные места:** настраивается в админ панели

### Переменные окружения
- `FLASK_ENV` - окружение (development/production)
- `SESSION_SECRET` - секретный ключ для сессий
- `DATABASE_URL` - URL базы данных
- `FLASK_APP` - точка входа приложения

## 🛠️ Разработка

### Структура кода
- **MVC архитектура** - четкое разделение логики
- **Модульная структура** - легко расширяемый код
- **Документированный код** - подробные комментарии

### Добавление новых функций
1. Создайте модель в `models.py`
2. Добавьте маршруты в `routes.py`
3. Создайте шаблоны в `templates/`
4. Добавьте стили в `static/css/`
5. Обновите документацию

### Миграции базы данных
```bash
# Создание миграции
alembic revision --autogenerate -m "Description"

# Применение миграций
alembic upgrade head
```

## 📚 Документация

### Дополнительные документы
- `PROJECT_ARCHITECTURE.md` - подробная архитектура
- `GITHUB_SETUP.md` - настройка GitHub
- `NGINX_SETUP.md` - настройка Nginx

### API документация
Основные эндпоинты описаны в разделе "Маршруты приложения".

## 🤝 Вклад в проект

1. Форкните репозиторий
2. Создайте ветку для новой функции
3. Внесите изменения
4. Создайте Pull Request

## 📄 Лицензия

MIT License - см. файл LICENSE для подробностей.

## 📞 Поддержка

При возникновении проблем:
1. Проверьте раздел "Отладка"
2. Создайте Issue в репозитории
3. Опишите проблему с подробностями

---

**ParkingBooker** - современное решение для управления парковочными местами аэропорта Шереметьево. 